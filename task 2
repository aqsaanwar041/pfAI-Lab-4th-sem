
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import LabelEncoder
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import accuracy_score

train = pd.read_csv("train.csv")
test = pd.read_csv("test.csv")

print("Train Loaded:", train.shape)
print("Test Loaded:", test.shape)

categorical = ["HomePlanet", "Destination", "CryoSleep", "VIP"]
numeric = ["Age", "RoomService", "FoodCourt", "ShoppingMall", "Spa", "VRDeck"]

for col in categorical:
    train[col].fillna(train[col].mode()[0], inplace=True)
    test[col].fillna(test[col].mode()[0], inplace=True)

for col in numeric:
    train[col].fillna(train[col].median(), inplace=True)
    test[col].fillna(test[col].median(), inplace=True)

label = LabelEncoder()

for col in ["HomePlanet", "Destination"]:
    train[col] = label.fit_transform(train[col])
    test[col] = label.transform(test[col])


train["CryoSleep"] = train["CryoSleep"].astype(int)
test["CryoSleep"] = test["CryoSleep"].astype(int)

train["VIP"] = train["VIP"].astype(int)
test["VIP"] = test["VIP"].astype(int)

train["Transported"] = train["Transported"].astype(int)

features = ["HomePlanet", "CryoSleep", "Age", "VIP",
            "RoomService", "FoodCourt", "ShoppingMall",
            "Spa", "VRDeck", "Destination"]

X = train[features]
y = train["Transported"]

X_train, X_val, y_train, y_val = train_test_split(
    X, y, test_size=0.2, random_state=42
)

model = RandomForestClassifier(n_estimators=200, random_state=42)
model.fit(X_train, y_train)

pred = model.predict(X_val)
print("Accuracy:", accuracy_score(y_val, pred))

test_pred = model.predict(test[features])
test_pred = test_pred.astype(bool)

submission = pd.DataFrame({
    "PassengerId": test["PassengerId"],
    "Transported": test_pred
})

submission.to_csv("submission.csv", index=False)
print("submission.csv created successfully!")

